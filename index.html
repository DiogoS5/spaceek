<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salas de Estudo - Universidade</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container-header">
          <div class="logo-area">
            <img src="imagens/logo.png" alt="Logo do Spaceek" class="logo">
            <span class="nome-empresa">Spaceek</span>
          </div>
          <nav class="menu">
            <a class="active">Início</a>
            <a href="ficheiros_html/mapa.html">Mapa</a>
            <a href="ficheiros_html/sobre.html">Sobre</a>
            <a href="ficheiros_html/contacto.html">Contacto</a>
          </nav>
          <div class="menu-hamburger" onclick="toggleMenu()">&#9776;</div>
        </div>
    </header>
      
    <main>
        <section class="hero">
            <div class="container">
                <h2>Encontre o melhor local para estudar</h2>
                <p>Pesquise salas de estudo disponíveis, verifique condições em tempo real e reserve seu espaço.</p>
                
                <div class="search-container">
                    <div class="search-box">
                        <input type="search" id="search-input" placeholder="Pesquisar salas de estudo...">
                        <button type="submit" class="search-button" id="search-button">Buscar</button>
                    </div>
                    <a href="ficheiros_html/mapa.html" class="map-button">Ver no Mapa</a>
                </div>
            </div>
        </section>

        <section class="results">
            <div class="container">
                <h2>Salas Disponíveis</h2>
                <p>Encontre a sala ideal para suas necessidades de estudo.</p>
                <div class="filter-tabs">
                    <button class="tab active" data-filter="todos">Todos</button>
                    <button class="tab" data-filter="biblioteca">Biblioteca</button>
                    <button class="tab" data-filter="laboratorio">Laboratórios</button>
                    <button class="tab" data-filter="sala">Salas de Aula</button>
                </div>
                
                <div id="loading-message" class="loading-message">Carregando salas...</div>
                <div id="error-message" class="error-message" style="display: none;">Erro ao carregar dados do Firebase.</div>
                
                <div class="study-rooms" id="study-rooms">
                    <!-- Os cards das salas serão gerados dinamicamente pelo JavaScript -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>© 2024 Spaceek. Todos os direitos reservados.</p>
            <nav>
                <a href="#">Termos de Serviço</a>
                <a href="#">Privacidade</a>
            </nav>
        </div>
    </footer>

    <script src="script.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBZrf6QJGbHiYzkmhm_hhBnb-hlfWAl9OM",
            authDomain: "spaceek-5869c.firebaseapp.com",
            projectId: "spaceek-5869c",
            storageBucket: "spaceek-5869c.appspot.com",
            messagingSenderId: "174315041988",
            appId: "1:174315041988:web:37ba8e2b2227ae395f8591",
            measurementId: "G-DJC1QL37JV"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Função para obter a cor baseada na temperatura
        function getTemperatureColor(temp) {
            if (temp < 18) return "cold";
            if (temp < 22) return "cool";
            if (temp < 25) return "comfortable";
            if (temp < 28) return "warm";
            return "hot";
        }

        // Função para obter a cor baseada na ocupação
        function getOccupancyColor(occupancy) {
            if (occupancy < 30) return "#22c55e"; // Verde
            if (occupancy < 70) return "#eab308"; // Amarelo
            return "#ef4444"; // Vermelho
        }

        // Função para obter a classe baseada no nível de ruído
        function getNoiseClass(noise) {
            switch(noise.toLowerCase()) {
                case "muito baixo": return "very-low";
                case "baixo": return "low";
                case "médio": return "medium";
                case "alto": return "high";
                default: return "medium";
            }
        }

        // Função para criar um card de sala
        function createRoomCard(room) {
            const tempColor = getTemperatureColor(room.temperatura);
            const occupancyColor = getOccupancyColor(room.ocupacao);
            const noiseClass = getNoiseClass(room.ruido);
            
            return `
                <div class="room-card" data-type="${room.tipo || 'sala'}">
                    <div class="room-header">
                        <h3>${room.nome}</h3>
                        <p>${room.local}</p>
                    </div>
                    <div class="room-indicators">
                        <div class="indicator">
                            <span class="indicator-label">Ocupação:</span>
                            <div class="progress-container">
                                <div class="progress-bar" style="width: ${room.ocupacao}%; background-color: ${occupancyColor};"></div>
                            </div>
                            <span class="indicator-value">${room.ocupacao}%</span>
                        </div>
                        <div class="indicator">
                            <span class="indicator-label">Temperatura:</span>
                            <span class="badge temperature ${tempColor}">${room.temperatura}°C</span>
                        </div>
                        <div class="indicator">
                            <span class="indicator-label">Nível de Ruído:</span>
                            <span class="badge noise ${noiseClass}">${room.ruido}</span>
                        </div>
                    </div>
                    <div class="room-actions">
                        <button class="button secondary">Detalhes</button>
                        <a href="ficheiros_html/mapa.html?sala=${encodeURIComponent(room.nome)}&local=${encodeURIComponent(room.local)}" class="button primary">Ver no Mapa</a>
                    </div>
                </div>
            `;
        }

        // Dados de exemplo caso o Firebase falhe
        const sampleRooms = [
            {
                nome: "Sala 101",
                local: "Bloco A",
                ocupacao: 30,
                temperatura: 22,
                ruido: "Baixo",
                tipo: "sala"
            },
            {
                nome: "Biblioteca Central",
                local: "Piso 2",
                ocupacao: 75,
                temperatura: 24,
                ruido: "Médio",
                tipo: "biblioteca"
            },
            {
                nome: "Laboratório 3",
                local: "Bloco C",
                ocupacao: 10,
                temperatura: 21,
                ruido: "Muito Baixo",
                tipo: "laboratorio"
            },
            {
                nome: "Sala 205",
                local: "Bloco B",
                ocupacao: 50,
                temperatura: 23,
                ruido: "Médio",
                tipo: "sala"
            },
            {
                nome: "Espaço Colaborativo",
                local: "Centro Estudantil",
                ocupacao: 90,
                temperatura: 27,
                ruido: "Alto",
                tipo: "sala"
            },
            {
                nome: "Sala Silenciosa",
                local: "Biblioteca",
                ocupacao: 40,
                temperatura: 19,
                ruido: "Muito Baixo",
                tipo: "biblioteca"
            }
        ];

        // Função para carregar as salas
        // Função para carregar as salas
function loadRooms() {
    const roomsContainer = document.getElementById('study-rooms');
    const loadingMessage = document.getElementById('loading-message');
    
    // Esconde a mensagem de carregamento
    loadingMessage.style.display = "none";
    
    // Carrega os dados de exemplo diretamente
    sampleRooms.forEach(room => {
        roomsContainer.innerHTML += createRoomCard(room);
    });
    
    // Adiciona os event listeners para os filtros
    setupFilters();
}
        // Função para configurar os filtros
        function setupFilters() {
            const tabs = document.querySelectorAll('.tab');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove a classe active de todas as tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Adiciona a classe active na tab clicada
                    tab.classList.add('active');
                    
                    // Filtra as salas
                    const filter = tab.getAttribute('data-filter');
                    filterRooms(filter);
                });
            });
        }

        // Função para filtrar as salas
        function filterRooms(filter) {
            const rooms = document.querySelectorAll('.room-card');
            
            rooms.forEach(room => {
                if (filter === 'todos' || room.getAttribute('data-type') === filter) {
                    room.style.display = 'block';
                } else {
                    room.style.display = 'none';
                }
            });
        }

        // Função para pesquisar salas
        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            
            searchButton.addEventListener('click', () => {
                const searchTerm = searchInput.value.toLowerCase();
                searchRooms(searchTerm);
            });
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const searchTerm = searchInput.value.toLowerCase();
                    searchRooms(searchTerm);
                }
            });
        }

        // Função para pesquisar salas
        function searchRooms(term) {
            const rooms = document.querySelectorAll('.room-card');
            
            rooms.forEach(room => {
                const roomName = room.querySelector('h3').textContent.toLowerCase();
                const roomLocation = room.querySelector('.room-header p').textContent.toLowerCase();
                
                if (roomName.includes(term) || roomLocation.includes(term)) {
                    room.style.display = 'block';
                } else {
                    room.style.display = 'none';
                }
            });
        }

        // Carrega as salas quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            loadRooms();
            setupSearch();
        });
    </script>
</body>
</html>